<!DOCTYPE html>
<html lang="ms" x-data="quizApp()" x-init="init()">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.2">
    <title>Ujian Rabun - Alpine.js</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs" defer></script>
</head>
<body class="bg-gray-100 min-h-screen flex justify-center p-4">
    <div class="bg-white rounded-xl shadow-lg w-full max-w-md p-6 mt-10" x-show="!showResult">
        <h1 class="text-2xl font-bold text-center mb-4">Ujian Rabun Jauh atau Dekat</h1>
        <template x-if="currentQuestion < questions.length">
            <div>
                <p class="text-lg mb-4" x-text="questions[currentQuestion].text"></p>
                <div class="space-y-3">
                    <template x-for="(answer, index) in questions[currentQuestion].options" :key="index">
                        <button 
                            class="w-full px-4 py-2 text-left border rounded-lg hover:bg-blue-100 transition"
                            :class="{'bg-blue-200': selectedAnswer === index}"
                            @click="selectAnswer(index)">
                            <span x-text="answer"></span>
                        </button>
                    </template>
                </div>
                <div class="mt-6 flex justify-between">
                    <button 
                        class="px-4 py-2 bg-gray-300 rounded-lg disabled:opacity-50"
                        @click="prevQuestion"
                        :disabled="currentQuestion === 0">
                        Sebelumnya
                    </button>
                    <button 
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg disabled:opacity-50"
                        @click="nextQuestion"
                        :disabled="selectedAnswer === null">
                        Seterusnya
                    </button>
                </div>
                <p class="mt-4 text-center text-sm text-gray-500">
                    Soalan <span x-text="currentQuestion+1"></span> daripada <span x-text="questions.length"></span>
                </p>
            </div>
        </template>
    </div>

    <!-- Hasil -->
    <div class="bg-white rounded-xl shadow-lg w-full max-w-md p-6 mt-10 text-center" x-show="showResult">
        <h2 class="text-2xl font-bold mb-4">Keputusan Ujian</h2>
        <p class="text-lg mb-4" x-text="resultText"></p>
        <button class="px-6 py-3 bg-green-500 text-white rounded-lg mt-4" @click="restart()">Cuba Lagi</button>
    </div>

    <script>
        function quizApp() {
            return {
                questions: [
                    { text: "1. Boleh baca teks di telefon pada jarak normal?", options: ["Ya, jelas", "Kabur"] },
                    { text: "2. Nampak papan tanda dari jarak 10 meter?", options: ["Jelas", "Kabur"] },
                    { text: "3. Perlu dekatkan buku untuk nampak jelas?", options: ["Ya", "Tidak"] },
                    { text: "4. Perlu jauhkan buku untuk nampak jelas?", options: ["Ya", "Tidak"] },
                    { text: "5. Bila baca lama, mata cepat letih?", options: ["Ya", "Tidak"] },
                    { text: "6. Boleh baca tulisan kecil di resit dengan mudah?", options: ["Ya", "Tidak"] },
                    { text: "7. Sukar nampak nombor plat kereta dari jauh?", options: ["Ya", "Tidak"] },
                    { text: "8. Boleh nampak skrin TV jelas dari jauh?", options: ["Ya", "Kabur"] },
                    { text: "9. Perlu mendekat bila tengok papan tulis?", options: ["Ya", "Tidak"] },
                    { text: "10. Bila melihat objek jauh, nampak kabur?", options: ["Ya", "Tidak"] }
                ],
                currentQuestion: 0,
                answers: [],
                selectedAnswer: null,
                showResult: false,
                resultText: "",
                init() {
                    this.currentQuestion = 0;
                },
                selectAnswer(index) {
                    this.selectedAnswer = index;
                },
                nextQuestion() {
                    this.answers[this.currentQuestion] = this.selectedAnswer;
                    this.selectedAnswer = null;
                    if (this.currentQuestion < this.questions.length - 1) {
                        this.currentQuestion++;
                        if (this.answers[this.currentQuestion] !== undefined) {
                            this.selectedAnswer = this.answers[this.currentQuestion];
                        }
                    } else {
                        this.calculateResult();
                    }
                },
                prevQuestion() {
                    if (this.currentQuestion > 0) {
                        this.currentQuestion--;
                        if (this.answers[this.currentQuestion] !== undefined) {
                            this.selectedAnswer = this.answers[this.currentQuestion];
                        }
                    }
                },
                calculateResult() {
                    let rabunDekatCount = 0;
                    let rabunJauhCount = 0;

                    this.answers.forEach((ans, index) => {
                        if (index === 0 && ans === 1) rabunDekatCount++; // Kabur dekat
                        if (index === 1 && ans === 1) rabunJauhCount++;  // Kabur jauh
                        if (index === 2 && ans === 0) rabunDekatCount++; // Perlu dekatkan
                        if (index === 3 && ans === 0) rabunJauhCount++;  // Perlu jauhkan
                        if (index === 6 && ans === 0) rabunJauhCount++;  // Sukar nampak jauh
                        if (index === 7 && ans === 1) rabunJauhCount++;  // Kabur TV jauh
                        if (index === 9 && ans === 0) rabunJauhCount++;  // Objek jauh kabur
                    });

                    if (rabunJauhCount > rabunDekatCount) {
                        this.resultText = "Anda berkemungkinan rabun jauh (myopia).";
                    } else if (rabunDekatCount > rabunJauhCount) {
                        this.resultText = "Anda berkemungkinan rabun dekat (hyperopia).";
                    } else {
                        this.resultText = "Penglihatan anda kelihatan normal.";
                    }

                    this.showResult = true;
                },
                restart() {
                    this.currentQuestion = 0;
                    this.answers = [];
                    this.selectedAnswer = null;
                    this.showResult = false;
                }
            }
        }
    </script>
</body>
</html>
